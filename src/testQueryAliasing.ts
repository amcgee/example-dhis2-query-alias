import fetchDHIS2WithAliasFallback from './fetchDHIS2WithAliasFallback.ts'
import fs from 'fs/promises'

const BASE_URL = process.argv[2] || 'https://play.im.dhis2.org/dev';
const USERNAME = process.argv[3] || 'admin';
const PASSWORD = process.argv[4] || 'district';
const OUT_FILE = process.argv[5] || './out.json';

const longEndpoint = "/api/41/analytics/events/query/eBAyeGv0exc?dimension=ou%3AImspTQPwCqd,eMyVanycQSC,qrur9Dvnyt5%3AGE%3A5%3ALE%3A10,oZg33kd9taw,fWIAEtYVEGk,msodh3rEMJa,Bpx0589u8y0%3Aw0gFTTmsUcF%3BPVLOW4bCshG%3BMAs88nJc9nL%3BoRVt7g429ZO,uIuxlbV1vRT%3AnlX2VoouN63%3BJ40PpdN4Wkk%3BjqBqIXoXpfy%3Bb0EsAxm8Nge,J5jldMd8OHv%3ACXw2yu5fodb%3BuYxK4wmcPqA%3BRXL3lPSK8oG%3BtDZVQ1WtwpA%3BEYbopBOJWsW,Cbuj0VCyDjL%3AGGghZsfu7qV%3Bf25dqv3Y7Z0,tUdBD1JDxpn%3AGT%3A1&filter=Zj7UnCAulEk.eMyVanycQSC&filter=Zj7UnCAulEk.qrur9Dvnyt5&filter=Zj7UnCAulEk.K6uUAvq500H%3AIN%3AA000%3BA001%3BA009%3BA00%3BA010%3BA011%3BA012%3BA013%3BA014%3BA01%3BA020%3BA021%3BA022%3BA028%3BA029%3BA02%3BA030%3BA031%3BA032%3BA033%3BA038%3BA039%3BA03%3BA040%3BA041%3BA042%3BA043%3BA044%3BA045%3BA046%3BA047%3BA048%3BA049%3BA04%3BA050%3BA051%3BA052%3BA053%3BA054%3BA058%3BA059%3BA05%3BA060%3BA061%3BA062%3BA063%3BA064%3BA065%3BA066%3BA067%3BA068%3BA069%3BA06%3BA070%3BA071%3BA072%3BA073%3BA078%3BA079%3BA07%3BA081%3BA082%3BA083%3BA084%3BA085%3BA08%3BA090%3BA099%3BA09%3BA150%3BA151%3BA152%3BA153%3BA154%3BA155%3BA156%3BA157%3BA158%3BA159%3BA15%3BA160%3BA161%3BA162%3BA163%3BA164%3BA165%3BA167%3BA168%3BA169%3BA16%3BA170%3BA171%3BA178%3BA179%3BA17%3BA180%3BA181%3BA182%3BA183%3BA184%3BA185%3BA186%3BA187%3BA188%3BA18%3BA190%3BA191%3BA192%3BA198%3BA199%3BA19%3BA200%3BA201%3BA202%3BA203%3BA207%3BA208%3BA209%3BA20%3BA210%3BA211%3BA212%3BA213%3BA217%3BA218%3BA219%3BA21%3BA220%3BA221%3BA222%3BA227%3BA228%3BA229%3BA22%3BA230%3BA231%3BA232%3BA233%3BA238%3BA239%3BA23%3BA240%3BA241%3BA242%3BA243%3BA244%3BA24%3BA250%3BA251%3BA259%3BA25%3BA260%3BA267%3BA268%3BA269%3BA26%3BA270%3BA278%3BA279%3BA27%3BA280%3BA281%3BA282%3BA288%3BA289%3BA28%3BA300%3BA301%3BA302%3BA303%3BA304%3BA305%3BA308%3BA309%3BA30%3BA310%3BA311%3BA318%3BA319%3BA31%3BA320%3BA321%3BA327%3BA328%3BA329%3BA32%3BA33%3BA34%3BA35%3BA360%3BA361%3BA362%3BA363%3BA368%3BA369%3BA36%3BA370%3BA371%3BA378%3BA379%3BA37%3BA38%3BA390%3BA391%3BA392%3BA393%3BA394%3BA395%3BA398%3BA399%3BA39%3BA400%3BA401%3BA402%3BA403%3BA408%3BA409%3BA40%3BA410%3BA411%3BA412%3BA413%3BA414%3BA415%3BA418%3BA419%3BA41%3BA420%3BA421%3BA422%3BA427%3BA428%3BA429%3BA42%3BA430%3BA431%3BA438%3BA439%3BA43%3BA440%3BA441%3BA448%3BA449%3BA44%3BA46%3BA480%3BA481%3BA482%3BA483%3BA484%3BA488%3BA48%3BA490%3BA491%3BA492%3BA493%3BA498%3BA499%3BA49%3BA500%3BA501%3BA502%3BA503%3BA504%3BA505%3BA506%3BA507%3BA509%3BA50%3BA510%3BA511%3BA512%3BA513%3BA514%3BA515%3BA519%3BA51%3BA520%3BA521%3BA522%3BA523%3BA527%3BA528%3BA529%3BA52%3BA530%3BA539%3BA53%3BA540%3BA541%3BA542%3BA543%3BA544%3BA545%3BA546%3BA548%3BA549%3BA54%3BA55%3BA560%3BA561%3BA562%3BA563%3BA564%3BA568%3BA56%3BA57%3BA58%3BA590%3BA598%3BA599%3BA59%3BA600%3BA601%3BA609%3BA60%3BA630%3BA638%3BA63%3BA64%3BA65%3BA660%3BA661%3BA662%3BA663%3BA664%3BA665%3BA666%3BA667%3BA668%3BA669%3BA66%3BA670%3BA671%3BA672%3BA673%3BA679%3BA67%3BA680%3BA681%3BA689%3BA68%3BA690%3BA691%3BA692%3BA698%3BA699%3BA69%3BA70%3BA710%3BA711%3BA719%3BA71%3BA740%3BA748%3BA749%3BA74%3BA750%3BA751%3BA752%3BA753%3BA759%3BA75%3BA770%3BA771%3BA772%3BA773%3BA778%3BA779%3BA77%3BA78%3BA790%3BA791%3BA798%3BA799%3BA79%3BA800%3BA801%3BA802%3BA803%3BA804%3BA809%3BA80%3BA810%3BA811%3BA812%3BA818%3BA819%3BA81%3BA820%3BA821%3BA829%3BA82%3BA830%3BA831%3BA832%3BA833%3BA834%3BA835%3BA836%3BA838%3BA839%3BA83%3BA840%3BA841%3BA848%3BA849%3BA84%3BA850%3BA851%3BA852%3BA858%3BA85%3BA86%3BA870%3BA871%3BA872%3BA878%3BA879%3BA87%3BA880%3BA881%3BA888%3BA88%3BA89%3BA90%3BA91%3BA920%3BA921%3BA922%3BA923%3BA924%3BA928%3BA929%3BA92%3BA930%3BA931%3BA932%3BA938%3BA93%3BA94%3BA950%3BA951%3BA959%3BA95%3BA960%3BA961%3BA962%3BA968%3BA969%3BA96%3BA980%3BA981%3BA982%3BA983%3BA984%3BA985%3BA988%3BA98%3BA99%3BB000%3BB001%3BB002%3BB003%3BB004%3BB005%3BB007%3BB008%3BB009%3BB00%3BB010%3BB011%3BB012%3BB018%3BB019%3BB01%3BB020%3BB021%3BB022%3BB023%3BB028%3BB029%3BB02%3BB03%3BB04%3BB050%3BB051%3BB052%3BB053%3BB054%3BB058%3BB059%3BB05%3BB060%3BB068%3BB069%3BB06%3BB07%3BB080%3BB081%3BB082%3BB083%3BB084%3BB085%3BB088%3BB08%3BB09%3BB150%3BB159%3BB15%3BB160%3BB161%3BB162%3BB169%3BB16%3BB170%3BB171%3BB172%3BB178%3BB179%3BB17%3BB180%3BB181%3BB182%3BB188%3BB189%3BB18%3BB190%3BB199%3BB19%3BB200%3BB201%3BB202%3BB203%3BB204%3BB205%3BB206%3BB207%3BB208%3BB209%3BB20%3BB210%3BB211%3BB212%3BB213%3BB217%3BB218%3BB219%3BB21%3BB220%3BB221%3BB222%3BB227%3BB22%3BB230%3BB231%3BB232%3BB238%3BB23%3BB24%3BB250%3BB251%3BB252%3BB258%3BB259%3BB25%3BB260%3BB261%3BB262%3BB263%3BB268%3BB269%3BB26%3BB270%3BB271%3BB278%3BB279%3BB27%3BB300%3BB301%3BB302%3BB303%3BB308%3BB309%3BB30%3BB330%3BB331%3BB332%3BB333%3BB334%3BB338%3BB33%3BB340%3BB341%3BB342%3BB343%3BB344%3BB348%3BB349%3BB34%3BB350%3BB351%3BB352%3BB353%3BB354%3BB355%3BB356%3BB358%3BB359%3BB35%3BB360%3BB361%3BB362%3BB363%3BB368%3BB369%3BB36%3BB370%3BB371%3BB372%3BB373%3BB374%3BB375%3BB376%3BB377%3BB378%3BB379%3BB37%3BB380%3BB381%3BB382%3BB383%3BB384%3BB387%3BB388%3BB389%3BB38%3BB390%3BB391%3BB392%3BB393%3BB394%3BB395%3BB399%3BB39%3BB400%3BB401%3BB402%3BB403%3BB407%3BB408%3BB409%3BB40%3BB410%3BB417%3BB418%3BB419%3BB41%3BB420%3BB421%3BB427%3BB428%3BB429%3BB42%3BB430%3BB431%3BB432%3BB438%3BB439%3BB43%3BB440%3BB441%3BB442%3BB447%3BB448%3BB449%3BB44%3BB450%3BB451%3BB452%3BB453%3BB457%3BB458%3BB459%3BB45%3BB460%3BB461%3BB462%3BB46%3BB500%3BB508%3BB509%3BB50%3BB510%3BB518%3BB519%3BB51%3BB520%3BB528%3BB529%3BB52%3BB530%3BB531%3BB538%3BB53%3BB54%3BB550%3BB551%3BB552%3BB559%3BB55%3BB560%3BB561%3BB569%3BB56%3BB570%3BB571%3BB572%3BB573%3BB574%3BB575%3BB57%3BB580%3BB581%3BB582%3BB583%3BB588%3BB589%3BB58%3BB59%3BB600%3BB601%3BB602%3BB608%3BB60%3BB64%3BB650%3BB651%3BB652%3BB653%3BB658%3BB659%3BB65%3BB660%3BB661%3BB662%3BB663%3BB664%3BB665%3BB668%3BB669%3BB66%3BB670%3BB671%3BB672%3BB673%3BB674%3BB675%3BB676%3BB677%3BB678%3BB679%3BB67%3BB680%3BB681%3BB689%3BB68%3BB690%3BB691%3BB698%3BB699%3BB69%3BB700%3BB701%3BB70%3BB710%3BB711%3BB718%3BB719%3BB71%3BB72%3BB73%3BB740%3BB741%3BB742%3BB743%3BB744%3BB748%3BB749%3BB74%3BB75%3BB760%3BB761%3BB768%3BB769%3BB76%3BB770%3BB778%3BB779%3BB77%3BB780%3BB781%3BB787%3BB789%3BB78%3BB79%3BB80%3BB810%3BB811%3BB812%3BB813%3BB814%3BB818%3BB81%3BB820%3BB829%3BB82%3BB830%3BB831%3BB832%3BB833%3BB834%3BB838%3BB839%3BB83%3BB850%3BB851%3BB852%3BB853%3BB854%3BB85%3BB86%3BB870%3BB871%3BB872%3BB873%3BB874%3BB878%3BB879%3BB87%3BB880%3BB881%3BB882%3BB883%3BB888%3BB889%3BB88%3BB89%3BB900%3BB901%3BB902%3BB908%3BB909%3BB90%3BB91%3BB92%3BB940%3BB941%3BB942%3BB948%3BB949%3BB94%3BB950%3BB951%3BB952%3BB953%3BB954%3BB955%3BB956%3BB957%3BB958%3BB95%3BB960%3BB961%3BB962%3BB963%3BB964%3BB965%3BB966%3BB967%3BB968%3BB96%3BB970%3BB971%3BB972%3BB973%3BB974%3BB975%3BB976%3BB977%3BB978%3BB97%3BB980%3BB981%3BB98%3BB99%3BC000%3BC001%3BC002%3BC003%3BC004%3BC005%3BC006%3BC008%3BC009%3BC00%3BC01%3BC020%3BC021%3BC022%3BC023%3BC024%3BC028%3BC029%3BC02%3BC030%3BC031%3BC039%3BC03%3BC040%3BC041%3BC048%3BC049%3BC04%3BC050%3BC051%3BC052%3BC058%3BC059%3BC05%3BC060%3BC061%3BC062%3BC068%3BC069%3BC06%3BC07%3BC080%3BC081%3BC088%3BC089%3BC08%3BC090%3BC091%3BC098%3BC099%3BC09%3BC100%3BC101%3BC102%3BC103%3BC104%3BC108%3BC109%3BC10%3BC110%3BC111%3BC112%3BC113%3BC118%3BC119%3BC11%3BC12%3BC130%3BC131%3BC132%3BC138%3BC139%3BC13%3BC140%3BC142%3BC148%3BC14%3BC150%3BC151%3BC152%3BC153%3BC154%3BC155%3BC158%3BC159%3BC15%3BC160%3BC161%3BC162%3BC163%3BC164%3BC165%3BC166%3BC168%3BC169%3BC16%3BC170%3BC171%3BC172%3BC173%3BC178%3BC179%3BC17%3BC181%3BC182%3BC183%3BC184%3BC185%3BC186%3BC187%3BC188%3BC189%3BC18%3BC19%3BC20%3BC210%3BC211%3BC212%3BC218%3BC21%3BC220%3BC221%3BC222%3BC223%3BC224%3BC227%3BC229%3BC22%3BC23%3BC240%3BC241%3BC248%3BC249%3BC24%3BC250%3BC251%3BC252%3BC253%3BC254%3BC257%3BC258%3BC259%3BC25%3BC260%3BC261%3BC268%3BC269%3BC26%3BC300%3BC301%3BC30%3BC310%3BC311%3BC312%3BC313%3BC318%3BC319%3BC31%3BC320%3BC321%3BC322%3BC323%3BC328%3BC329%3BC32%3BC33%3BC340%3BC341%3BC342%3BC343%3BC348%3BC349%3BC34%3BC37%3BC380%3BC381%3BC382%3BC383%3BC384%3BC388%3BC38%3BC390%3BC398%3BC399%3BC39%3BC400%3BC401%3BC402%3BC403%3BC408%3BC409%3BC40%3BC410%3BC411%3BC412%3BC413%3BC414%3BC418%3BC419%3BC41%3BC430%3BC431%3BC432%3BC433%3BC434%3BC435%3BC436%3BC437%3BC438%3BC439%3BC43%3BC440%3BC441%3BC442%3BC443%3BC444%3BC445%3BC446%3BC447%3BC448%3BC449%3BC44%3BC450%3BC451%3BC452%3BC457%3BC459%3BC45%3BC460%3BC461%3BC462%3BC463%3BC467%3BC468%3BC469%3BC46%3BC470%3BC471%3BC472%3BC473%3BC474%3BC475%3BC476%3BC478%3BC479%3BC47%3BC480%3BC481%3BC482%3BC488%3BC48%3BC490%3BC491%3BC492%3BC493%3BC494%3BC495%3BC496%3BC498%3BC499%3BC49%3BC500%3BC501%3BC502%3BC503%3BC504%3BC505%3BC506%3BC508%3BC509%3BC50%3BC510%3BC511%3BC512%3BC518%3BC519%3BC51%3BC52%3BC530%3BC531%3BC538%3BC539%3BC53%3BC540%3BC541%3BC542%3BC543%3BC548%3BC549%3BC54%3BC55%3BC56%3BC570%3BC571%3BC572%3BC573%3BC574%3BC577%3BC578%3BC579%3BC57%3BC58%3BC600%3BC601%3BC602%3BC608%3BC609%3BC60%3BC61%3BC620%3BC621%3BC629%3BC62%3BC630%3BC631%3BC632%3BC637%3BC638%3BC639%3BC63%3BC64%3BC65%3BC66%3BC670%3BC671%3BC672%3BC673%3BC674%3BC675%3BC676%3BC677%3BC678%3BC679%3BC67%3BC680%3BC681%3BC688%3BC689%3BC68%3BC690%3BC691%3BC692%3BC693%3BC694%3BC695%3BC696%3BC698%3BC699%3BC69%3BC700%3BC701%3BC709%3BC70%3BC710%3BC711%3BC712%3BC713%3BC714%3BC715%3BC716%3BC717%3BC718%3BC719%3BC71%3BC720%3BC721%3BC722%3BC723%3BC724%3BC725%3BC728%3BC729%3BC72%3BC73%3BC740%3BC741%3BC749%3BC74%3BC750%3BC751%3BC752%3BC753%3BC754%3BC755%3BC758%3BC759%3BC75%3BC760%3BC761%3BC762%3BC763%3BC764%3BC765%3BC767%3BC768%3BC76%3BC770%3BC771%3BC772%3BC773%3BC774%3BC775%3BC778%3BC779&headers=eventdate,ouname,eMyVanycQSC,qrur9Dvnyt5,oZg33kd9taw,fWIAEtYVEGk,msodh3rEMJa,Bpx0589u8y0,uIuxlbV1vRT,J5jldMd8OHv,Cbuj0VCyDjL,tUdBD1JDxpn&totalPages=false&eventDate=THIS_YEAR&displayProperty=SHORTNAME&outputType=EVENT&pageSize=100&page=1&includeMetadataDetails=true&stage=Zj7UnCAulEk"
async function main() {
    const result = await fetchDHIS2WithAliasFallback({
        baseUrl: BASE_URL,
        username: USERNAME,
        password: PASSWORD,
        reportStatus: console.warn
    }, longEndpoint)
    if (result.status >= 200 && result.status < 300 && result.data) {
        console.warn(`Success, writing to file ${OUT_FILE}`)
        await fs.writeFile(OUT_FILE, JSON.stringify(result.data, undefined, 2))
    } else {
        console.error(`Failed with HTTP error ${result.status}`)
    }
}
main()